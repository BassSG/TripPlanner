<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
   <base target="_top">
   <title>Trip Planner</title>
   
   <!-- Favicon -->
   <link rel="icon" type="image/png" sizes="192x192" href="https://s21-kling.klingai.com/bs2/upload-ylab-stunt-sgp/se/ai_portal_sgp_mmu_txt2img_aiweb_v15/53e5aa90-d7b3-457c-8217-5266265c1a5a_image.png?x-kcdn-pid=112372">

   <!-- Apple Touch Icon -->
   <link rel="apple-touch-icon" sizes="180x180" href="https://s21-kling.klingai.com/bs2/upload-ylab-stunt-sgp/se/ai_portal_sgp_mmu_txt2img_aiweb_v15/53e5aa90-d7b3-457c-8217-5266265c1a5a_image.png?x-kcdn-pid=112372">

   <!-- Manifest -->
   <link rel="manifest" href="/manifest.json">

   <!-- Theme Color -->
   <meta name="theme-color" content="#ffffff">

   <!-- Enable fullscreen for iOS -->
   <meta name="apple-mobile-web-app-capable" content="yes">
   <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

   <!-- ปรับ CSS: เอา overflow: hidden ออก เพื่อให้ iOS Safari สามารถ scroll/เปิดคีย์บอร์ดได้เต็มที่ -->
   <style>
      html, body {
         margin: 0;
         padding: 0;
         width: 100%;
         height: 100%;
         /* overflow: hidden;  <-- ยกเลิกการซ่อน scroll เพื่อไม่ให้ iOS มีปัญหาคีย์บอร์ด */
         font-family: Arial, sans-serif;
         background-color: #ffffff;
      }
      /* ถ้าต้องการให้เลื่อนหน้าน้อยที่สุด อาจตั้งค่าเป็น auto (หรือ visible) */
      body {
         overflow: auto;
      }
      iframe {
         position: absolute;
         top: 0;
         left: 0;
         width: 100%;
         height: 100%;
         border: 0;
         -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on iOS */
         z-index: 1; 
         pointer-events: auto;
      }
   </style>
</head>
<body>
   <iframe 
      id="webframe"
      src="https://script.google.com/macros/s/AKfycbyEhiEFqaFgLmjdIIiGU9LGU8tIE3Xw-MtTJrS9mpuN7C1AiV4Y845Bttaj4ilgiETb/exec"
      allow="autoplay; fullscreen"
      sandbox="allow-forms allow-same-origin allow-scripts allow-popups allow-modals"
      tabindex="0">
   </iframe>

   <!-- JavaScript หลังการปรับแก้ -->
   <script>
      const iframe = document.getElementById('webframe');

      // **ลบ** document.addEventListener('touchstart', ...) เพื่อเลี่ยงการบังคับ focus() จาก parent
      // document.addEventListener('touchstart', function() {
      //    iframe.contentWindow.focus();
      // });

      iframe.addEventListener('load', function() {
         const iframeDoc = iframe.contentWindow.document;

         // **ลบ** ส่วนที่บังคับ focus ใน iframeDoc.body
         // iframeDoc.body.addEventListener('click', function() {
         //    iframe.contentWindow.focus();
         // });

         // ถ้ายังอยากคง logic สำหรับ focus input ได้อัตโนมัติเมื่อคลิก input
         // ในกรณีบน iOS ถ้า user แตะ input อยู่แล้ว Safari จะจัดการ focus ให้อัตโนมัติ
         // โค้ดด้านล่างนี้อาจไม่จำเป็น แต่ถ้าจะเก็บก็ได้
         iframeDoc.addEventListener('focusin', function(e) {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
               // ดีเลย์เล็กน้อยเผื่อ iOS
               setTimeout(() => {
                  e.target.focus();
               }, 0);
            }
         });
      });
   </script>
</body>
</html>
